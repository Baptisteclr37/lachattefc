<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Résultats LA CHATTE</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #121212;
      color: #eee;
      margin: 20px;
    }
    h1 {
      text-align: center;
      color: #ffcc00;
      text-shadow: 1px 1px 4px #000;
      margin-bottom: 30px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      box-shadow: 0 0 15px #ffcc00aa;
      background: #222;
      border-radius: 10px;
      overflow: hidden;
    }
    thead {
      background: #ffcc00;
      color: #121212;
      font-weight: bold;
      font-size: 1.1em;
    }
    th, td {
      padding: 10px 15px;
      text-align: center;
      border-bottom: 1px solid #444;
    }
    tbody tr:hover {
      background: #333;
      cursor: pointer;
    }
    tbody tr:nth-child(even) {
      background: #2a2a2a;
    }
    /* Petit style "foot" */
    caption {
      font-size: 1.3em;
      margin-bottom: 10px;
      font-weight: bold;
      color: #ffcc00;
      text-shadow: 0 0 5px #ffcc00aa;
    }
  </style>
</head>
<body>
  <h1>Résultats LA CHATTE</h1>

  <table id="resultsTable" aria-label="Tableau des résultats">
    <caption>Résultats de la journée</caption>
    <thead></thead>
    <tbody></tbody>
  </table>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    const url = 'https://corsproxy.io/?https://docs.google.com/spreadsheets/d/e/2PACX-1vSuc-XJn1YmTCl-5WtrYeOKBS8nfTnRsFCfeNMRvzJcbavfGIX9SUSQdlZnVNPQtapcgr2m4tAwYznB/pub?gid=363948896&single=true&output=csv';

    Papa.parse(url, {
      download: true,
      header: false,
      complete: function(results) {
        console.log("Données CSV :", results.data);

        // Sélection des parties du tableau
        const thead = document.querySelector("#resultsTable thead");
        const tbody = document.querySelector("#resultsTable tbody");

        // Clear au cas où
        thead.innerHTML = "";
        tbody.innerHTML = "";

        // Récupérer la première ligne comme header
        const headers = results.data[0];
        const trHead = document.createElement("tr");
        headers.forEach(head => {
          const th = document.createElement("th");
          th.textContent = head;
          trHead.appendChild(th);
        });
        thead.appendChild(trHead);

        // Boucle sur toutes les lignes restantes
        for (let i = 1; i < results.data.length; i++) {
          const row = results.data[i];
          // Ignore les lignes vides (fin de fichier parfois)
          if (!row || row.every(cell => cell === "")) continue;

          const tr = document.createElement("tr");
          row.forEach(cell => {
            const td = document.createElement("td");
            td.textContent = cell;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        }
      },
      error: function(err) {
        document.getElementById("resultsTable").textContent = "Erreur : " + err.message;
      }
    });
  </script>
</body>
</html>
